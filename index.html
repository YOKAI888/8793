<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŒ¸é¼»ããã‚ã£ã—ã‚‡ã„ğŸŒ¸(æ”¹)</title>
<style>
  html,body{margin:0;padding:0;overflow:hidden;height:100%;background:linear-gradient(270deg,#1a1a2e,#162447,#1f4068,#1b1b2f,#0f0f1f);background-size:1200% 1200%;animation:g 40s ease infinite}
  @keyframes g{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

  .snow{position:absolute;pointer-events:none;font-size:22px;animation:snowfall linear forwards;opacity:0.85;}
  @keyframes snowfall{
    0%{transform:translateY(-100px) translateX(0) rotate(0deg);opacity:0}
    10%{opacity:0.85}
    100%{transform:translateY(calc(100vh + 100px)) translateX(var(--swing)) rotate(360deg);opacity:0}
  }
  .ground-snow{position:absolute;bottom:0;width:10px;height:10px;background:rgba(255,255,255,0.9);border-radius:50%;box-shadow:0 0 10px #fff;pointer-events:none;}
  .poop{position:absolute;font-size:16px;color:#ffccff;text-shadow:0 0 5px #fff;cursor:pointer;user-select:none;will-change: transform;} /* é«˜é€ŸåŒ–ã®å‘ªæ–‡ */
  .face{position:absolute;font-size:45px;color:#fff;text-shadow:0 0 12px #000;pointer-events:none;z-index:100;}
</style>
</head>
<body>

<script>
const poops = [];
const pastelColors = ["#ffeef5","#e0ffff","#f0e8ff","#e8fff0","#fff8e8","#fff0ff"];
let mouseX = 0, mouseY = 0;
let isMouseActive = false;
let groundSnowCount = 0; // ç©é›ªåˆ¶é™ç”¨

// ğŸ’©ç”Ÿæˆ (300åŒ¹ãã‚‰ã„ãŒä¸€ç•ªç¾ã—ã„ã¨åˆ¤æ–­ã—ã¾ã—ãŸ)
for(let i=0;i<300;i++){
  const p = document.createElement('div');
  p.className='poop';
  p.innerText='ğŸ’©';
  p.x = Math.random()*window.innerWidth;
  p.y = Math.random()*window.innerHeight;
  p.vx = Math.random()*0.8 - 0.4;
  p.vy = Math.random()*0.8 - 0.4;
  p.style.left = p.x + 'px';
  p.style.top = p.y + 'px';
  document.body.appendChild(p);
  poops.push(p);
}

document.addEventListener('mousemove', e => {
  mouseX = e.clientX; mouseY = e.clientY;
  isMouseActive = true;
  clearTimeout(window.mouseTimer);
  window.mouseTimer = setTimeout(()=> isMouseActive = false, 1000);
});

// é›ªé™ã‚‰ã›ï¼ˆå¾Œç‰‡ä»˜ã‘æ©Ÿèƒ½ä»˜ãï¼‰
function snow(){
  for(let i=0;i<6;i++){
    const s = document.createElement('div');
    s.className='snow';
    s.innerText = ['â„','â…','â†','âœ´','âœ¿'][Math.floor(Math.random()*5)];
    s.style.color = pastelColors[Math.floor(Math.random()*pastelColors.length)];
    const startX = Math.random()*window.innerWidth;
    s.style.left = startX + 'px';
    s.style.fontSize = Math.random()*14 + 18 + 'px';
    const dur = Math.random()*8 + 10;
    s.style.animationDuration = dur +'s';
    const swing = Math.random()*200 - 100;
    s.style.setProperty('--swing', swing +'px');
    document.body.appendChild(s);

    // ã‚¢ãƒ‹ãƒ¡çµ‚äº†æ™‚ã«ç¢ºå®Ÿã«å‰Šé™¤
    setTimeout(() => {
      s.remove();
      // ç¢ºç‡ã§ç©ã‚‚ã‚‹
      if(Math.random()<0.4 && groundSnowCount < 200){
        const g = document.createElement('div');
        g.className='ground-snow';
        g.style.left = (startX + swing) + 'px';
        g.style.opacity = Math.random()*0.5 + 0.5;
        document.body.appendChild(g);
        groundSnowCount++;
        setTimeout(() => { g.remove(); groundSnowCount--; }, 8000);
      }
    }, dur * 1000);
  }
}
setInterval(snow, 500);

// æŒ™å‹•ï¼ˆè¨ˆç®—ã‚’è»½ãï¼‰
function animate(){
  poops.forEach(p=>{
    if(isMouseActive){
      p.x += (mouseX - p.x) * 0.02;
      p.y += (mouseY - p.y) * 0.02;
    } else {
      p.x += p.vx;
      p.y += p.vy;
      if(p.x<0||p.x>window.innerWidth) p.vx *= -1;
      if(p.y<0||p.y>window.innerHeight) p.vy *= -1;
    }
    p.style.left = p.x + 'px';
    p.style.top = p.y + 'px';
  });
  requestAnimationFrame(animate);
}
animate();

// ã‚¯ãƒªãƒƒã‚¯åå¿œï¼ˆæ¡œã®ã‚´ãƒŸæƒé™¤ã‚‚å®Œç’§ã«ï¼‰
document.addEventListener('click', e=>{
  const clickX = e.clientX;
  const clickY = e.clientY;

  // è¿‘ãã®ğŸ’©ã‚’åˆ¤å®šï¼ˆå…¨ä»¶ãƒ«ãƒ¼ãƒ—ã¯å¤‰ãˆãšã€å‡¦ç†ã‚’è»½ãï¼‰
  let hit = false;
  poops.forEach(p => {
    const dx = clickX - p.x;
    const dy = clickY - p.y;
    if(dx*dx + dy*dy < 2500){ // åˆ¤å®šè·é›¢ã‚’å°‘ã—èª¿æ•´
      hit = true;
    }
  });

  if(hit){
    if(Math.random() < 0.15){ // æ¡œå¹é›ªã®ç¢ºç‡ã‚’å°‘ã—èª¿æ•´
      for(let i=0;i<40;i++){
        const sakura = document.createElement('div');
        sakura.className='snow';
        sakura.innerText='ğŸŒ¸';
        sakura.style.left = clickX + (Math.random()*200-100) +'px';
        sakura.style.top = clickY + (Math.random()*100-50) +'px';
        sakura.style.animationDuration = (Math.random()*3 + 2) +'s';
        document.body.appendChild(sakura);
        setTimeout(()=>sakura.remove(), 4000);
      }
    } else {
      const f = document.createElement('div');
      f.className='face';
      f.innerText = Math.random()<0.1 ? 'ãƒã‚«ãŒæŠ¼ã™ã…ã€œ( Â´_ã‚ï½€)' : '( Â´,_ã‚ï½€)ï¾Œï¾Ÿï½¯';
      f.style.left = clickX + 'px';
      f.style.top = clickY + 'px';
      document.body.appendChild(f);
      setTimeout(()=>f.remove(), 800);
    }
  }
});
</script>
</body>
</html>